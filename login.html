<!DOCTYPE html>
<html lang="en">
   
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZK Gaming Hub - Succinct Network Login</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --accent: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --dark: #0f172a;
            --dark-lighter: #1e293b;
            --dark-card: #334155;
            --text: #e2e8f0;
            --text-dim: #94a3b8;
            --border: #475569;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--dark);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Animated Background */
        .bg-pattern {
            position: fixed;
            inset: 0;
            z-index: -1;
            opacity: 0.03;
            background-image: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 35px,
                rgba(255, 255, 255, 0.05) 35px,
                rgba(255, 255, 255, 0.05) 70px
            );
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            animation: float 20s ease-in-out infinite;
        }

        .orb-1 {
            width: 600px;
            height: 600px;
            background: var(--primary);
            top: -300px;
            left: -300px;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: var(--secondary);
            bottom: -200px;
            right: -200px;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -30px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }

        /* Login Container */
        .login-container {
            width: 100%;
            max-width: 480px;
            padding: 2rem;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Logo Section */
        .logo-section {
            text-align: center;
            margin-bottom: 3rem;
        }

        .logo {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: pulse 2s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 1.1rem;
        }

        /* Login Card */
        .login-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .access-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--primary);
            border-radius: 2rem;
            padding: 0.5rem 1rem;
            margin-bottom: 2rem;
            font-size: 0.9rem;
            color: var(--primary);
        }

        .access-badge-icon {
            width: 16px;
            height: 16px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.7rem;
        }

        /* Login Methods */
        .login-methods {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .login-method {
            background: var(--dark-card);
            border: 2px solid var(--border);
            border-radius: 0.75rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
            color: var(--text);
        }

        .login-method:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.2);
        }

        .login-method.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .method-icon {
            width: 48px;
            height: 48px;
            background: var(--dark-lighter);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .method-info {
            flex: 1;
        }

        .method-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .method-description {
            font-size: 0.875rem;
            color: var(--text-dim);
        }

        .method-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--error);
        }

        .status-indicator.verified {
            background: var(--accent);
        }

        /* Verification Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 2rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--dark-lighter);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: var(--text-dim);
        }

        /* Verification Steps */
        .verification-steps {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--dark-card);
            border-radius: 0.5rem;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .step.active {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .step.completed {
            border-color: var(--accent);
            background: rgba(16, 185, 129, 0.1);
        }

        .step-number {
            width: 32px;
            height: 32px;
            background: var(--dark-lighter);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid var(--border);
        }

        .step.active .step-number {
            border-color: var(--primary);
            color: var(--primary);
        }

        .step.completed .step-number {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .step-status {
            font-size: 0.875rem;
            color: var(--text-dim);
        }

        /* Loading Animation */
        .loader {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Error Message */
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--error);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            text-align: center;
            display: none;
        }

        .error-message.show {
            display: block;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Footer */
        .login-footer {
            text-align: center;
            margin-top: 2rem;
            color: var(--text-dim);
            font-size: 0.875rem;
        }

        .login-footer a {
            color: var(--primary);
            text-decoration: none;
        }

        .login-footer a:hover {
            text-decoration: underline;
        }

        /* Success Animation */
        .success-overlay {
            position: fixed;
            inset: 0;
            background: rgba(16, 185, 129, 0.1);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .success-overlay.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .success-content {
            text-align: center;
            animation: successBounce 0.5s ease;
        }

        @keyframes successBounce {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .success-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        /* Mobile Responsive */
        @media (max-width: 480px) {
            .login-container {
                padding: 1rem;
            }

            .title {
                font-size: 2rem;
            }

            .login-card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Background -->
    <div class="bg-pattern"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <!-- Login Container -->
    <div class="login-container">
        <!-- Logo Section -->
        <div class="logo-section">
            <div class="logo">🎮</div>
            <h1 class="title">ZK Gaming Hub</h1>
            <p class="subtitle">Exclusive access for Succinct Network members</p>
        </div>

        <!-- Login Card -->
        <div class="login-card">
            <div class="access-badge">
                <div class="access-badge-icon">✓</div>
                <span>Succinct Network Verified Access</span>
            </div>

            <div class="login-methods">
                <!-- Wallet Login -->
                <button class="login-method" onclick="initiateLogin('wallet')">
                    <div class="method-icon">🔗</div>
                    <div class="method-info">
                        <div class="method-title">Connect Wallet</div>
                        <div class="method-description">Use your Succinct-linked wallet</div>
                    </div>
                    <div class="method-status">
                        <div class="status-indicator" id="walletStatus"></div>
                        <span id="walletStatusText">Not connected</span>
                    </div>
                </button>

                <!-- GitHub Login -->
                <button class="login-method" onclick="initiateLogin('github')">
                    <div class="method-icon">🐙</div>
                    <div class="method-info">
                        <div class="method-title">GitHub Account</div>
                        <div class="method-description">Login with GitHub OAuth</div>
                    </div>
                    <div class="method-status">
                        <div class="status-indicator" id="githubStatus"></div>
                        <span id="githubStatusText">Available</span>
                    </div>
                </button>

                <!-- API Key Login -->
                <button class="login-method" onclick="initiateLogin('apikey')">
                    <div class="method-icon">🔑</div>
                    <div class="method-info">
                        <div class="method-title">Succinct API Key</div>
                        <div class="method-description">Enter your Succinct API credentials</div>
                    </div>
                    <div class="method-status">
                        <div class="status-indicator" id="apikeyStatus"></div>
                        <span id="apikeyStatusText">Manual entry</span>
                    </div>
                </button>
            </div>

            <div class="error-message" id="errorMessage">
                <strong>Access Denied:</strong> <span id="errorText">You must be a verified Succinct Network member</span>
            </div>
        </div>

        <div class="login-footer">
            Not part of Succinct Network? 
            <a href="https://succinct.xyz" target="_blank">Learn more</a>
        </div>
    </div>

    <!-- Verification Modal -->
    <div class="modal-overlay" id="verificationModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Verifying Succinct Access</h2>
                <p class="modal-subtitle" id="modalSubtitle">Checking your credentials against Succinct Stats API</p>
            </div>

            <div class="verification-steps">
                <div class="step" id="step1">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">Connect to Provider</div>
                        <div class="step-status" id="step1Status">Waiting...</div>
                    </div>
                </div>

                <div class="step" id="step2">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-title">Verify with Succinct Stats API</div>
                        <div class="step-status" id="step2Status">Pending...</div>
                    </div>
                </div>

                <div class="step" id="step3">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-title">Generate Access Token</div>
                        <div class="step-status" id="step3Status">Pending...</div>
                    </div>
                </div>
            </div>

            <div id="modalContent"></div>

            <div style="display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" id="modalActionBtn" style="display: none;">Continue</button>
            </div>
        </div>
    </div>

    <!-- Success Overlay -->
    <div class="success-overlay" id="successOverlay">
        <div class="success-content">
            <div class="success-icon">✅</div>
            <h2 style="font-size: 2rem; margin-bottom: 1rem;">Access Granted!</h2>
            <p style="color: var(--text-dim); margin-bottom: 2rem;">Welcome to ZK Gaming Hub</p>
            <div class="loader"></div>
        </div>
    </div>

    <script>
        // Succinct Stats API Configuration
        const SUCCINCT_API = {
            baseUrl: 'https://api.succinct.xyz/stats',
            endpoints: {
                verifyUser: '/verify/user',
                verifyWallet: '/verify/wallet',
                getProverStats: '/prover/stats'
            }
        };

        // Login State
        let loginState = {
            method: null,
            walletAddress: null,
            githubUsername: null,
            apiKey: null,
            isVerified: false
        };

        // Initiate Login Flow
        async function initiateLogin(method) {
            loginState.method = method;
            showModal();
            
            switch(method) {
                case 'wallet':
                    await handleWalletLogin();
                    break;
                case 'github':
                    await handleGitHubLogin();
                    break;
                case 'apikey':
                    await handleAPIKeyLogin();
                    break;
            }
        }

        // Wallet Login Handler
        async function handleWalletLogin() {
            updateStep(1, 'active', 'Connecting to wallet...');
            
            try {
                // Check if wallet is available
                if (typeof window.ethereum === 'undefined') {
                    throw new Error('No wallet detected. Please install MetaMask.');
                }

                // Request account access
                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                if (accounts.length === 0) {
                    throw new Error('No accounts found');
                }

                loginState.walletAddress = accounts[0];
                updateStep(1, 'completed', `Connected: ${accounts[0].slice(0, 6)}...${accounts[0].slice(-4)}`);
                
                // Verify with Succinct
                await verifyWithSuccinct();
                
            } catch (error) {
                handleError(error.message);
            }
        }

        // GitHub Login Handler
        async function handleGitHubLogin() {
            updateStep(1, 'active', 'Redirecting to GitHub...');
            
            // Show GitHub login form in modal
            document.getElementById('modalContent').innerHTML = `
                <div style="text-align: center; padding: 2rem 0;">
                    <p style="margin-bottom: 1rem;">Enter your GitHub username to verify Succinct access:</p>
                    <input type="text" 
                           id="githubUsername" 
                           placeholder="Your GitHub username" 
                           style="width: 100%; padding: 0.75rem; background: var(--dark-card); border: 1px solid var(--border); border-radius: 0.5rem; color: var(--text); margin-bottom: 1rem;">
                    <button class="btn btn-primary" onclick="verifyGitHub()">
                        Verify GitHub Account
                    </button>
                </div>
            `;
        }

        // API Key Login Handler
        async function handleAPIKeyLogin() {
            updateStep(1, 'active', 'Enter API credentials...');
            
            // Show API key form in modal
            document.getElementById('modalContent').innerHTML = `
                <div style="padding: 2rem 0;">
                    <div style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Succinct API Key</label>
                        <input type="text" 
                               id="apiKeyInput" 
                               placeholder="Your Succinct API key" 
                               style="width: 100%; padding: 0.75rem; background: var(--dark-card); border: 1px solid var(--border); border-radius: 0.5rem; color: var(--text);">
                    </div>
                    <p style="color: var(--text-dim); font-size: 0.875rem; margin-bottom: 1rem;">
                        Find your API key in the Succinct dashboard
                    </p>
                    <div style="text-align: center;">
                        <button class="btn btn-primary" onclick="verifyAPIKey()">
                            Verify API Key
                        </button>
                    </div>
                </div>
            `;
        }

        // Verify with Succinct Stats API
        async function verifyWithSuccinct() {
            updateStep(2, 'active', 'Contacting Succinct Stats API...');
            
            try {
                // Simulate API call to Succinct Stats
                // In production, this would be a real API call
                const response = await simulateSuccinctAPICall();
                
                if (response.isSuccinctMember) {
                    updateStep(2, 'completed', 'Verified as Succinct member');
                    await generateAccessToken();
                } else {
                    throw new Error('Not a verified Succinct Network member');
                }
                
            } catch (error) {
                updateStep(2, 'error', error.message);
                handleError(error.message);
            }
        }

        // Simulate Succinct API Call
        async function simulateSuccinctAPICall() {
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Mock verification logic
            // In production, this would check against actual Succinct Stats API
            const verifiedAddresses = [
                '0x1234567890123456789012345678901234567890',
                '0xabcdefabcdefabcdefabcdefabcdefabcdefabcd'
            ];
            
            const verifiedGitHubUsers = ['succinctlabs', 'zkgamer', 'developer123'];
            const validAPIKeys = ['sk_test_12345', 'sk_live_67890'];
            
            let isSuccinctMember = false;
            let memberData = {};
            
            if (loginState.walletAddress) {
                // For demo: Check if last 4 chars contain '1337' to simulate member
                isSuccinctMember = loginState.walletAddress.toLowerCase().includes('1337');
                memberData = {
                    address: loginState.walletAddress,
                    zkProofsGenerated: Math.floor(Math.random() * 1000),
                    networkContribution: Math.floor(Math.random() * 100)
                };
            } else if (loginState.githubUsername) {
                isSuccinctMember = verifiedGitHubUsers.includes(loginState.githubUsername.toLowerCase());
                memberData = {
                    github: loginState.githubUsername,
                    repositories: Math.floor(Math.random() * 10),
                    contributions: Math.floor(Math.random() * 500)
                };
            } else if (loginState.apiKey) {
                isSuccinctMember = loginState.apiKey.startsWith('sk_');
                memberData = {
                    apiKey: loginState.apiKey.slice(0, 10) + '...',
                    tier: 'Premium',
                    requestsToday: Math.floor(Math.random() * 10000)
                };
            }
            
            return {
                isSuccinctMember,
                memberData,
                timestamp: new Date().toISOString()
            };
        }

        // Generate Access Token
        async function generateAccessToken() {
            updateStep(3, 'active', 'Generating access token...');
            
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Generate mock JWT token
            const token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...' + Date.now();
            localStorage.setItem('zkGamingToken', token);
            localStorage.setItem('succinctVerified', 'true');
            
            updateStep(3, 'completed', 'Access token created');
            
            // Show success
            setTimeout(() => {
                closeModal();
                showSuccess();
            }, 1000);
        }

        // Verify GitHub
        async function verifyGitHub() {
            const username = document.getElementById('githubUsername').value.trim();
            if (!username) {
                alert('Please enter your GitHub username');
                return;
            }
            
            loginState.githubUsername = username;
            updateStep(1, 'completed', `GitHub: ${username}`);
            document.getElementById('modalContent').innerHTML = '';
            
            await verifyWithSuccinct();
        }

        // Verify API Key
        async function verifyAPIKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            if (!apiKey) {
                alert('Please enter your API key');
                return;
            }
            
            loginState.apiKey = apiKey;
            updateStep(1, 'completed', 'API key provided');
            document.getElementById('modalContent').innerHTML = '';
            
            await verifyWithSuccinct();
        }

        // Update Verification Step
        function updateStep(stepNum, status, message) {
            const step = document.getElementById(`step${stepNum}`);
            const stepStatus = document.getElementById(`step${stepNum}Status`);
            
            // Remove all status classes
            step.classList.remove('active', 'completed', 'error');
            
            // Add appropriate class
            if (status === 'active') {
                step.classList.add('active');
                stepStatus.innerHTML = `<span class="loader" style="width: 16px; height: 16px;"></span> ${message}`;
            } else if (status === 'completed') {
                step.classList.add('completed');
                stepStatus.innerHTML = `✓ ${message}`;
            } else if (status === 'error') {
                stepStatus.innerHTML = `✗ ${message}`;
                stepStatus.style.color = 'var(--error)';
            }
        }

        // Show Modal
        function showModal() {
            document.getElementById('verificationModal').classList.add('active');
            // Reset steps
            for (let i = 1; i <= 3; i++) {
                updateStep(i, '', 'Pending...');
            }
            document.getElementById('modalContent').innerHTML = '';
        }

        // Close Modal
        function closeModal() {
            document.getElementById('verificationModal').classList.remove('active');
        }

        // Handle Error
        function handleError(message) {
            closeModal();
            const errorEl = document.getElementById('errorMessage');
            document.getElementById('errorText').textContent = message;
            errorEl.classList.add('show');
            
            setTimeout(() => {
                errorEl.classList.remove('show');
            }, 5000);
        }

        // Show Success
        function showSuccess() {
            document.getElementById('successOverlay').classList.add('show');
            
            // Redirect after 2 seconds
            setTimeout(() => {
                window.location.href = '/hub';
            }, 2000);
        }

        // Check if already verified
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.getItem('succinctVerified') === 'true') {
                // Auto-redirect if already verified
                showSuccess();
            }
        });
        // Basic error handling
window.addEventListener('error', function(e) {
  console.error('Script error:', e.error);
});

// Handle missing functions gracefully
function handleMissingAPI() {
  if (typeof zkAPI === 'undefined') {
    console.warn('API not available, using mock data');
    // Initialize mock API
  }
}

        // Add some helpful console messages
        console.log('%c🎮 ZK Gaming Hub', 'font-size: 20px; color: #6366f1; font-weight: bold;');
        console.log('%cTo simulate Succinct member access:', 'color: #10b981;');
        console.log('1. Use a wallet address containing "1337"');
        console.log('2. Use GitHub username: succinctlabs, zkgamer, or developer123');
        console.log('3. Use any API key starting with "sk_"');
    </script>
</body>
</html>